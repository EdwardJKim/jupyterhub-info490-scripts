---
- hosts:
  - jupyterhub_nodes
  vars:
    download:
      - "2001.csv.bz2"
      - "airports.csv"
      - "carriers.csv"
      - "plane-data.csv"
    compressed:
      - "2001.csv.bz2"
  tasks:
  - name: create data directory
    file: path=/srv/shared/data state=directory
  
  - name: download airline dataset
    get_url: url=http://stat-computing.org/dataexpo/2009/{{ item }} dest=/srv/shared/data/{{ item }}
    with_items:
    - "{{ download }}"
  
  - name: uncompress csv files
    shell: bzip2 -d -k -f /srv/shared/data/{{ item }}
    with_items:
    - "{{ compressed }}"
